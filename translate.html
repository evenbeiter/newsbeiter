<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Email Translator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
    }
    #drop-zone {
      border: 2px dashed #6c757d;
      border-radius: 10px;
      padding: 40px;
      text-align: center;
      color: #6c757d;
      background: white;
      cursor: pointer;
      margin-bottom: 20px;
    }
    #drop-zone.dragover {
      border-color: #0d6efd;
      color: #0d6efd;
      background: #e9f5ff;
    }
    .translation-block {
      margin-top: 20px;
    }
    .en-text {
      font-weight: 500;
      color: #212529;
    }
    .zh-text {
      color: #495057;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <div class="container d-flex vh-100">
    <div class="row justify-content-center align-self-center w-100">
      <div class="col-md-8">
        <!-- æ‹–æ›³ / é»žæ“Šä¸Šå‚³ -->
        <div id="drop-zone">
          <h5>ðŸ“© æ‹–æ›³æˆ–é»žæ“Šä¸Šå‚³éƒµä»¶æª” (.eml / .msg)</h5>
          <input type="file" id="fileInput" accept=".eml,.msg" hidden>
          <p class="small">æˆ–ç›´æŽ¥åœ¨ä¸‹æ–¹è²¼ä¸Šéƒµä»¶å…§å®¹</p>
        </div>
        <!-- è²¼ä¸Šæ–‡å­—å€ -->
        <textarea id="paste-area" class="form-control" rows="6" 
          placeholder="åœ¨é€™è£¡è²¼ä¸Šéƒµä»¶å…§å®¹"></textarea>
        <button id="translateBtn" class="btn btn-primary mt-2">ç¿»è­¯è²¼ä¸Šå…§å®¹</button>

        <!-- ç¿»è­¯çµæžœ -->
        <div id="output" class="translation-block"></div>
      </div>
    </div>
  </div>

  <script>
    // æ¨¡æ“¬ç¿»è­¯å‡½æ•¸ï¼Œé€™è£¡å‡è¨­ä½ å·²ç¶“æœ‰ translateToChinese()
    function translateToChinese(text) {
      return "ã€ä¸­æ–‡ç¿»è­¯ã€‘" + text; // TODO: æ›æˆä½ çš„ç¿»è­¯é‚è¼¯
    }

    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('fileInput');
    const output = document.getElementById('output');
    const pasteArea = document.getElementById('paste-area');
    const translateBtn = document.getElementById('translateBtn');

    // é˜²æ­¢é è¨­è¡Œç‚º (é¿å…æ‰“é–‹æª”æ¡ˆ)
    ['dragenter','dragover','dragleave','drop'].forEach(eventName => {
      dropZone.addEventListener(eventName, e => e.preventDefault());
      document.body.addEventListener(eventName, e => e.preventDefault());
    });

    // æ‹–æ›³æ•ˆæžœ
    dropZone.addEventListener('dragover', () => dropZone.classList.add('dragover'));
    dropZone.addEventListener('dragleave', () => dropZone.classList.remove('dragover'));

    // æ‹–æ›³æª”æ¡ˆé€²ä¾†
    dropZone.addEventListener('drop', e => {
      dropZone.classList.remove('dragover');
      handleFile(e.dataTransfer.files[0]);
    });

    // é»žæ“Šé¸æª”
    dropZone.addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', e => {
      if (e.target.files[0]) handleFile(e.target.files[0]);
    });

    // è™•ç†æª”æ¡ˆ
    function handleFile(file) {
      const reader = new FileReader();
      reader.onload = () => {
        processText(reader.result);
      };
      reader.readAsText(file);
    }

    // ç¿»è­¯è²¼ä¸Šçš„å…§å®¹
    translateBtn.addEventListener('click', () => {
      const text = pasteArea.value.trim();
      if (text) processText(text);
    });

    // é¡¯ç¤ºç¿»è­¯çµæžœ
    function processText(text) {
      const paragraphs = text.split(/\r?\n\r?\n/);
      output.innerHTML = "";
      paragraphs.forEach(p => {
        if (p.trim() === "") return;
        const enDiv = document.createElement("div");
        enDiv.className = "en-text";
        enDiv.textContent = p.trim();

        const zhDiv = document.createElement("div");
        zhDiv.className = "zh-text";
        zhDiv.textContent = translateToChinese(p.trim());

        output.appendChild(enDiv);
        output.appendChild(zhDiv);
      });
    }
  </script>
</body>
</html>